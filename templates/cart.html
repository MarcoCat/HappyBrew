{% extends "base.html" %} {% block title %}Cart{% endblock %} {% block content
%}
<main class="cartPage">
  {% if current_user.is_authenticated %}

  <h1 class="cartTitle">Cart</h1>
  <p class="processWord">You are almost done !</p>
  <p class="processNote">Before you add items into cart, it will show your previous order for your reference ~</p>

  <div class="cartPageLU">
    <div class="orderdetail">

      {% for order in orders %}
      <section>
        <h2>Order Detail</h2>
        <p>Name: {{ order.name }}</p>
        <p>Address: {{ order.address }}</p>
        <form action="/update_quantity" method="POST">
          <input type="hidden" name="order_id" value="{{ order.id }}" />
          <table class="cartTable">
            <thead>
              <tr>
                <th>Item</th>
                <th>Quantity</th>
                <th>Price</th>
              </tr>
            </thead>
            <tbody>
              {% for product_order in order.products %}
              <tr>
                <td>{{ product_order.product.name }}</td>
                <td>
                  <input
                    class="quantityInput"
                    type="number"
                    name="quantity[]"
                    value="{{ product_order.quantity }}"
                  />
                  <input
                    type="hidden"
                    name="product_order_id[]"
                    value="{{ product_order.id }}"
                  />
                </td>
                <td>{{ product_order.product.price }}</td>


                <td>
                  <form action="/delete_item" method="POST">
                    <input type="hidden" name="product_id" value="{{ product_order.product_id }}">
                    <input type="hidden" name="order_id" value="{{ product_order.order_id }}">
                    <button class="deleteButton" type="submit">Delete</button>
                  </form>
                </td>
              

              </tr>
              {% endfor %}
               
            </tbody>
          </table>
          <button class="quantityUpdateB" type="submit">Update</button>
        </form>
      </section>
      {% endfor %}
    </div>

    <section class="sumArea">
      <img
        src="{{ url_for('static', filename='image/cartPage/cuteBubbleTeaCart.png') }}"
        alt="4 bubble tea images"
        width="85"
        height="45"
      />
      <h3>Total price:</h3>
      <p class="sumPrice">$ {{ "{:.2f}".format(total) }}</p>
      <div class="cartButton">
        <a class="checkoutLink" href="checkout">Ready to Checkout!</a>
        <a class="backMenuLink" href="menu">Back to menu</a>
      </div>
    </section>
  </div>

  
  {% else %}
    <aside>Please log in/ sign up first.</aside>
  {% endif %}


</main>

{% endblock %}


